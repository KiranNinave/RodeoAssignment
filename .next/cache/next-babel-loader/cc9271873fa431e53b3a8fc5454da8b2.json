{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _toConsumableArray from \"@babel/runtime-corejs2/helpers/esm/toConsumableArray\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nvar _jsxFileName = \"/home/kiran/Desktop/next/RodeoAssignment/pages/index.js\";\nvar __jsx = React.createElement;\nimport React from \"react\";\nimport { getPopularMoviesApi } from \"../apis/movieApis\";\nimport InfiniteScroll from \"react-infinite-scroll-component\";\nimport Link from \"next/link\"; // style\n\nimport \"bootstrap/dist/css/bootstrap.min.css\";\nimport \"antd/dist/antd.css\"; // style compoents\n\nimport { Container, Row, Col } from \"react-bootstrap\"; // layout\n\nimport Header from \"../layouts/Header\"; // compoents\n\nimport MovieCard from \"../components/MovieCard\";\n\nvar Index =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(Index, _React$Component);\n\n  function Index(props) {\n    var _this;\n\n    _classCallCheck(this, Index);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Index).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_this), \"fetchMovies\",\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee() {\n      var page, response;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n\n              _this.setState({\n                loading: true\n              });\n\n              page = _this.state.page;\n              _context.next = 5;\n              return getPopularMoviesApi({\n                page: page\n              });\n\n            case 5:\n              response = _context.sent;\n\n              _this.setState({\n                movies: [].concat(_toConsumableArray(_this.state.movies), _toConsumableArray(response.results)),\n                hasMore: page <= response.total_pages\n              });\n\n              _context.next = 12;\n              break;\n\n            case 9:\n              _context.prev = 9;\n              _context.t0 = _context[\"catch\"](0);\n              console.log(_context.t0);\n\n            case 12:\n              _context.prev = 12;\n              if (_this.isComponentMounted) _this.setState({\n                loading: false\n              });\n              return _context.finish(12);\n\n            case 15:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[0, 9, 12, 15]]);\n    })));\n\n    _defineProperty(_assertThisInitialized(_this), \"loadMore\",\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee3() {\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              if (_this.isComponentMounted) {\n                _this.setState(function (prevState) {\n                  return {\n                    page: prevState.page + 1\n                  };\n                },\n                /*#__PURE__*/\n                _asyncToGenerator(\n                /*#__PURE__*/\n                _regeneratorRuntime.mark(function _callee2() {\n                  return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n                    while (1) {\n                      switch (_context2.prev = _context2.next) {\n                        case 0:\n                          _context2.next = 2;\n                          return _this.fetchMovies();\n\n                        case 2:\n                          return _context2.abrupt(\"return\", _context2.sent);\n\n                        case 3:\n                        case \"end\":\n                          return _context2.stop();\n                      }\n                    }\n                  }, _callee2);\n                })));\n              }\n\n            case 1:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    })));\n\n    _this.state = {\n      hasMore: true,\n      loading: false,\n      page: 1,\n      movies: []\n    };\n    _this.isComponentMounted = true;\n    return _this;\n  }\n\n  _createClass(Index, [{\n    key: \"componentDidMount\",\n    value: function () {\n      var _componentDidMount = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee4() {\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                _context4.next = 2;\n                return this.fetchMovies();\n\n              case 2:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n\n      function componentDidMount() {\n        return _componentDidMount.apply(this, arguments);\n      }\n\n      return componentDidMount;\n    }()\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this.isComponentMounted = false;\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return __jsx(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 68\n        },\n        __self: this\n      }, __jsx(Header, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 69\n        },\n        __self: this\n      }), __jsx(Container, {\n        style: {\n          marginTop: 70\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 70\n        },\n        __self: this\n      }, __jsx(InfiniteScroll, {\n        dataLength: this.state.movies.length //This is important field to render the next data\n        ,\n        next: this.loadMore,\n        hasMore: this.state.hasMore,\n        loader: __jsx(\"h4\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 75\n          },\n          __self: this\n        }, \"Loading...\"),\n        endMessage: __jsx(\"p\", {\n          style: {\n            textAlign: \"center\"\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 77\n          },\n          __self: this\n        }, __jsx(\"b\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 78\n          },\n          __self: this\n        }, \"Yay! You have seen it all\")),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 71\n        },\n        __self: this\n      }, __jsx(Row, {\n        style: {\n          justifyContent: \"center\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 82\n        },\n        __self: this\n      }, this.state.movies.map(function (movie, index) {\n        return __jsx(\"div\", {\n          key: movie.id.toString() + index,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 84\n          },\n          __self: this\n        }, __jsx(Col, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 85\n          },\n          __self: this\n        }, __jsx(MovieCard, {\n          movie: movie,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 86\n          },\n          __self: this\n        })));\n      })))));\n    }\n  }]);\n\n  return Index;\n}(React.Component);\n\nexport default Index;","map":{"version":3,"sources":["/home/kiran/Desktop/next/RodeoAssignment/pages/index.js"],"names":["React","getPopularMoviesApi","InfiniteScroll","Link","Container","Row","Col","Header","MovieCard","Index","props","setState","loading","page","state","response","movies","results","hasMore","total_pages","console","log","isComponentMounted","prevState","fetchMovies","marginTop","length","loadMore","textAlign","justifyContent","map","movie","index","id","toString","Component"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport { getPopularMoviesApi } from \"../apis/movieApis\";\nimport InfiniteScroll from \"react-infinite-scroll-component\";\nimport Link from \"next/link\";\n\n// style\nimport \"bootstrap/dist/css/bootstrap.min.css\";\nimport \"antd/dist/antd.css\";\n\n// style compoents\nimport { Container, Row, Col } from \"react-bootstrap\";\n\n// layout\nimport Header from \"../layouts/Header\";\n\n// compoents\nimport MovieCard from \"../components/MovieCard\";\n\nclass Index extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      hasMore: true,\n      loading: false,\n      page: 1,\n      movies: []\n    };\n    this.isComponentMounted = true;\n  }\n\n  async componentDidMount() {\n    await this.fetchMovies();\n  }\n\n  componentWillUnmount() {\n    this.isComponentMounted = false;\n  }\n\n  fetchMovies = async () => {\n    try {\n      this.setState({ loading: true });\n      const { page } = this.state;\n      const response = await getPopularMoviesApi({ page });\n      this.setState({\n        movies: [...this.state.movies, ...response.results],\n        hasMore: page <= response.total_pages\n      });\n    } catch (err) {\n      console.log(err);\n    } finally {\n      if (this.isComponentMounted) this.setState({ loading: false });\n    }\n  };\n\n  loadMore = async () => {\n    if (this.isComponentMounted) {\n      this.setState(\n        prevState => ({\n          page: prevState.page + 1\n        }),\n        async () => await this.fetchMovies()\n      );\n    }\n  };\n\n  render() {\n    return (\n      <div>\n        <Header></Header>\n        <Container style={{ marginTop: 70 }}>\n          <InfiniteScroll\n            dataLength={this.state.movies.length} //This is important field to render the next data\n            next={this.loadMore}\n            hasMore={this.state.hasMore}\n            loader={<h4>Loading...</h4>}\n            endMessage={\n              <p style={{ textAlign: \"center\" }}>\n                <b>Yay! You have seen it all</b>\n              </p>\n            }\n          >\n            <Row style={{ justifyContent: \"center\" }}>\n              {this.state.movies.map((movie, index) => (\n                <div key={movie.id.toString() + index}>\n                  <Col>\n                    <MovieCard movie={movie} />\n                  </Col>\n                </div>\n              ))}\n            </Row>\n          </InfiniteScroll>\n        </Container>\n      </div>\n    );\n  }\n}\n\nexport default Index;\n"]},"metadata":{},"sourceType":"module"}